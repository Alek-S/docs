<html>
<head>
<title>NodeDocs</title>
<script src="/dnode.js"></script>
</head>
<body>
  <h1>List of all tags:</h1>
  <div id="list-of-tags"></div><br />
  <h1>List of articles with tag `<span id="current-tag"></span>`:</h1>
  <div id="list-of-articles"></div><br />
  <h1>Contents of Article `<span id="current-article"></span>`:</h1>
  <div id="article"></div>
</body>
<script>
  window.onload = function () {
    var remote = null;
    loadTag = function (tag) {
      document.getElementById("current-tag").innerHTML = tag;
      remote.getGuides(tag, function (err, list) {
        if (err) {
          document.getElementById("list-of-articles").innerHTML = err;
          return;
        }
        document.getElementById("list-of-articles").innerHTML = "";
        for (var i = 0; i < list.length; ++i) {
          document.getElementById("list-of-articles").innerHTML +=
              "<a href='#' onclick='loadArticle(\""+list[i]+"\")'>"+list[i]+"</a> ";
        }
      });
    }

    loadArticle = function (article) {
      remote.getGuide(article, function (err, guide) {
        document.getElementById("current-article").innerHTML = article;
        if (err) {
          document.getElementById("article").innerHTML = err;
          return;
        }
        var article_ = guide.content;
        delete guide.content;
        document.getElementById("article").innerHTML = JSON.stringify(guide) +
          "<br /><br />" +article_.replace("\\n","<br />");
      });
    }



    DNode.connect(function (remote_) {
      remote = remote_;
      remote.getTags(function (err, tags) {
        if (err) {
          document.getElementById("list-of-tags").innerHTML = err;
          return;
        }

        for (var i = 0; i < tags.length; ++i) {
          document.getElementById("list-of-tags").innerHTML +=
              "<a href='#' onclick='loadTag(\""+tags[i]+"\")'>"+tags[i]+"</a> ";
        }
      });
    });
  }
</script>
</html>
